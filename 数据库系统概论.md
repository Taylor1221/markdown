# 第一章 基础篇

## 第1章 绪论

### 1.1 数据库系统概述

#### 1.1.1 数据库的4个基本概念

**1. 数据（data）**

- 描述事物的符号记录称为数据。
- 数据的含义称为数据的语义，数据与其予以是不可分的。

**2. 数据库（DataBase，DB）**
​		**数据库是长期储存在计算机内、有组织的、可共享的大量数据的集合**。数据库中的数据按一定的数据模型组织、描述和储存，具有**较小的冗余度(redundancy)**、**较高的数据独立性（data independency）**和**易扩展性(scalability)**，并**可为各种用户共享**。数据库数据具有三个基本特点：

- **永久存储**
- **有组织**
- **可共享**

**3. 数据库管理系统（DataBase Management System，DBMS）**
​		数据库管理系统是位于用户与操作系统之间的一层数据管理软件。数据库管理系统和操作系统一样是**计算机的基础软件**，也是一个大型复杂的软件系统。它的主要功能包括以下几个方面:
​		**(1) 数据定义功能**
        数据库管理系统提供数据定义语言（Data Definition Language，DDL)，用户通过它可以方便地对数据库中的数据对象的组成与结构进行定义。
​		**(2) 数据组织、存储和管理**
​		数据库管理系统要分类组织、存储和管理各种数据，包括数据字典、用户数据、数据的存取路径等。要确定以何种文件结构和存取方式在存储级上组织这些数据，如何实现数据之间的联系。数据组织和存储的基本目标是提高存储空间利用率和方便存取，提供多种存取方法（如索引查找、hash查找、顺序查找等）来提高存取效率。
​		**(3) 数据操纵功能**
        数据库管理系统还提供数据操纵语言(（Data Manipulation Language，DML)，用户可以使用它操纵数据，实现对数据库的基本操作，如查询、插入、删除和修改等。
​		**(4) 数据库的事务管理和运行管理**
        数据库在建立、运用和维护时由数据库管理系统统一管理和控制，以保证事务的正确运行，保证数据的安全性、完整性、多用户对数据的并发使用及发生故障后的系统恢复。
​		**(5) 数据库的建议和维护功能**
​		**(6) 其他功能**

**4. 数据库系统（DataBase System，DBS）**

​		数据库系统是由**数据库**、**数据库管理系统**（及其应用开发工具）、**应用程序**和**数据库管理员**（DataBase Administrator,DBA)组成的**存储**、**管理**、**处理**和**维护数据**的**系统**。

#### 1.1.2 数据库系统的特点

- **数据结构化**
- **数据的共享性高、冗余度低且易扩充**
- **数据独立性高**
- **数据由数据库管理系统统一管理和控制**

### 1.2 数据模型

​		==数据模型（data model）==也是一种模型，它是**对现实世界数据特征的抽象**。也就是说**数据模型是用来描述数据、组织数据和对数据进行操作的**。

​		***数据模型是数据库系统的核心和基础。***

#### 1.2.1 两类数据模型

​		根据模型**应用目的不同**，可以将这些模型划分为两大类，它们分别属于两个不同的层次。**第一类是概念模型，第二类是逻辑模型和物理模型**。
​		**第一类概念模型（conceptual model)**，也称**信息模型**，它是按用户的观点来对数据和信息建模，主要**用于数据库设计**。
​		**第二类中的逻辑模型**主要包括**层次模型(hierarchical model)**、**网状模型(network model**、**关系模型（relational model)**、**面向对象数据模型（object oriented data model)**和**对象关系数据模型（object relational data model)**、**半结构化数据模型(semistructured data model)**等。它是按计算机系统的观点对数据建模，主要**用于数据库管理系统的实现**。

#### 1.2.2 概念模型

![image-20220212135504775](https://gitee.com/enchantedqaq/cloudimage/raw/master/img/image-20220212135504775.png)

​		概念模型实际上是现实世界到机器世界的一个中间层次，用于信息世界的建模，是现实世界到信息世界的第一层抽象。

​		**1. 信息世界中的基本概念**

​		(1) **实体 (entity)**
​		**客观存在并可相互区别的事物称为实体**。实体可以是具体的人、事、物，也可以是抽象的概念或联系，例如，一个职工、一个学生、一个部门、一门课、学生的一次选课、部门的一次订货、教师与院系的工作关系（即某位教师在某院系工作）等都是实体。

​		(2) **属性 (attribute)**
​		**实体所具有的某一特性称为属性**。一个实体可以由若干个属性来刻画。例如，学生实体可以由学号、姓名、性别、出生年月、所在院系、入学时间等属性组成，属性组合(201315121，张山，男，199505，计算机系，2013）即表征了一个学生。

​		(3) **码 (key)**
​		**唯一标识实体的属性集称为码**。例如学号是学生实体的码。

​		(4) **实体型 (entity type)**
​		**具有相同属性的实体必然具有共同的特征和性质**。用实体名及其属性名集合来抽象和刻画同类实体，称为实体型。例如，学生(学号，姓名，性别，出生年月，所在院系，入学时间)就是一个实体型。

​		(5) **实体集 (entity set)**
​		**同一类型实体的集合称为实体集**。例如，全体学生就是一个实体集。

​		(6) **联系 (relationship)**
​		在现实世界中，事物内部以及事物之间是有联系的，这些联系在信息世界中反映为实体（型）内部的联系和实体（型）之间的联系。实体内部的联系通常是指组成实体的各属性之间的联系，**实体之间的联系通常是指不同实体集之间的联系**。
​		实体之间的联系有 **一对一**、**一对多**和多对多等多种类型。

​		**2. 概念模型的一种表示方法：实体-联系方法**

​		概念模型是对信息世界建模，所以概念模型应该能够方便、准确地表示出上述信息世界中的常用概念。概念模型的表示方法很多，其中最为常用的是P.P.S.Chen于1976年提出的**实体-联系方法（Entity-Relationship approach)**。该方法用E-R图(E-R diagram)来描述现实世界的概念模型，**E-R方法也称为E-R模型**。

#### 1.2.3 数据模型的组成要素

​		一般地讲，数据模型是严格定义的一组概念的集合。这些概念精确地描述了系统的静态特性、动态特性和完整性约束条件(integrity constraints)。因此**数据模型通常由数据结构、数据操作和数据的完整性约束条件三部分组成**。

​		**1. 数据结构**
​		数据结构描述数据库的组成对象以及对象之间的联系。也就是说，数据结构描述的内容有两类:一类是与对象的类型、内容、性质有关的，如网状模型中的数据项、记录，关系模型中的域、属性、关系等;一类是与数据之间联系有关的对象，如网状模型中的系型( set type)。
​		数据结构是所描述的对象类型的集合，是对系统静态特性的描述。

​		**2. 数据操作**
​		数据操作是指对数据库中各种对象（型）的实例（值）允许执行的操作的集合，包括操作及有关的操作规则。
​		数据库主要有查询和更新（包括插入、删除、修改）两大类操作。数据模型必须定义这些操作的确切含义、操作符号、操作规则（如优先级）以及实现操作的语言。
​		
​		**3. 数据的完整性约束条件**
​		数据的完整性约束条件是一组完整性规则。完整性规则是给定的数据模型中数据及其联系所具有的制约和依存规则，用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容。

#### 1.2.4 常用的数据模型

- **层次模型（hierarchical model）**
- **网状模型（network model）**
- **关系模型（relationship model）**
- **面向对象数据模型（object oriented data model）**
- **对象关系数据模型（object relational data model）**
- **半结构化数据模型（semistructure data model）**

#### 1.2.5 层次模型

**1. 层次模型的数据结构（树形结构）**

​		在数据库中定义满足下面两个条件的基本层次联系的集合为层次模型：
​		(1) **有且只有一个结点没有双亲结点，这个结点称为根结点;**
​		(2) **根以外的其他结点有且只有一个双亲结点。**

​		在层次模型中，==每个结点表示一个记录类型，记录类型之间的联系用结点之间的连线(有向边)表示，这种联系是父子之间的一对多的联系==。这就使得**层次数据库系统只能处理一对多的实体联系**。

**2. 层次模型的数据操作与完整性约束**

​		层次模型的数据操纵主要有查询、插入、删除和更新。进行插入、删除、更新操作时要满足层次模型的完整性约束条件。

- 进行插入操作时,如果没有相应的双亲结点值就不能插入它的子女结点值。
- 进行删除操作时，如果删除双亲结点值，则相应的子女结点值也将被同时删除。

**3. 层次模型的优缺点**

​	层次模型的==优点==主要有:

- **层次模型的数据结构比较简单清晰**。
- **层次数据库的查询效率高（通常用指针实现）**。
- **层次数据模型提供了良好的完整性支持**。

​	层次模型的==缺点==主要有:

- 现实世界中很多联系是非层次性的，如结点之间具有**多对多联系，不适合用层次模型表示**。
- 如果一个结点具有多个双亲结点等，用层次模型表示这类联系就很笨拙，只能通过引入冗余数据（易产生不一致性）或创建非自然的数据结构（引入虚拟结点）来解决。**对插入和删除操作的限制比较多**，因此应用程序的编写比较复杂。
- **查询子女结点必须通过双亲结点**。
- 由于结构严密,**层次命令趋于程序化**。

***==层次模型更适合一对多的层次联系！！！==***

#### 1.2.6 网状模型

​		网状数据库系统采用网状模型作为数据的组织方式。**网状数据模型的典型代表是DBTG系统,亦称CODASYL 系统**。

**1. 网状模型的数据结构**

​		在数据库中，把满足以下两个条件的基本层次联系集合称为网状模型:
​		(1) **允许一个以上的结点无双亲**。
​		(2) **一个结点可以有多于一个的双亲**。

​		网状模型是一种比层次模型更具普遍性的结构。它去掉了层次模型的两个限制，**允许多个结点没有双亲结点**，**允许结点有多个双亲结点**;此外它还**允许两个结点之间有多种联系**（称之为复合联系)。因此，网状模型可以更直接地去描述现实世界。而层次模型实际上是网状模型的一个特例。

**2. 网状模型的数据操作与完整性约束**

​		(1) **支持记录码的概念，码即唯一标识记录的数据项的集合**。例如，学生记录(（如图1.13）中学号是码,因此数据库中不允许学生记录中学号出现重复值。
​		(2) **保证一个联系中双亲记录和子女记录之间是一对多的联系**。
​		(3) **可以支持双亲记录和子女记录之间的某些约束条件**。例如，有些子女记录要求双亲记录存在才能插入，双亲记录删除时也连同删除。例如图1.13中选课记录就应该满足这种约束条件,学生选课记录值必须是数据库中存在的某一学生选修存在的某一门课的记录。DBTG提供了“属籍类别”的概念来描述这类约束条件。

**3. 网状模型的优缺点**

​	网状模型的==优点==主要有:

- **能够更为直接地描述现实世界，如一个结点可以有多个双亲，结点之间可以有多种联系**。
- **具有良好的性能,存取效率较高**。

​	网状模型的==缺点==主要有:

- **结构比较复杂**，而且随着应用环境的扩大，数据库的结构就变得越来越复杂，不利于最终用户掌握。
- **网状模型的DDL、DML复杂**,并且要嵌入某一种高级语言(如 COBOL、C)中用户不容易掌握,不容易使用。
- 由于记录之间的联系是通过存取路径实现的，应用程序在访问数据时必须选择适当的存取路径，因此**用户必须了解系统结构的细节，加重了编写应用程序的负担**。

#### 1.2.7 关系模型（最重要）

**1. 关系模型的数据结构**

​		**从用户观点看，关系模型由一组关系组成。每个关系的数据结构是一张规范化的二维表**。以学生登记表为例：

|   学  号   | 姓  名 | 年  龄 | 性  别 | 系  名 | 年  级 |
| :--------: | :----: | :----: | :----: | :----: | :----: |
| 1710050103 | 陈致超 |   23   |   男   | 社会学 |  2017  |
| 1710050104 | 邓时凯 |   21   |   女   | 商品学 |  2017  |
| 1710050105 |  胡澳  |   22   |   男   |  工学  |  2017  |
|     ……     |   ……   |   ……   |   ……   |   ……   |   ……   |

- **关系 (relation)**：**一个关系对应通常说的一张表**，例如上图的这张学生登记表。

- **元组 (tuple)**：**表中的一行即为一个元组**。

- **属性 (attribute)**：**表中的一列即为一个属性，给每一个属性起一个名称即属性名**。如上图的表有6列，对应6个属性（学号，姓名，年龄，性别，系名和年级)。

- **码 (key)**：**也称为码键。表中的某个属性组，它可以唯一确定一个元组**，如上图的学号可以唯一确定一个学生，也就成为本关系的码。

- **域 (domain)**：**域是一组具有相同数据类型的值的集合**。属性的取值范围来自某个域。如人的年龄一般在 1—120岁之间，大学生年龄属性的域是(15~45岁),性别的域是(男，女)，系名的域是一个学校所有系名的集合。

- **分量**：**元组中的一个属性值**。

- **关系模式**：对关系的描述，一般表示为: **关系名 (属性1，属性2，…，属性n)**

  ​		例如，上面的关系可描述为: 学生 (学号，姓名，年龄，性别，系名，年级)

​		关系模型要求关系必须是规范化的，即要求关系必须满足一定的规范条件，这些规范条件中最基本的一条就是，关系的每一个分量必须是一个不可分的数据项，也就是说，不允许表中还有表。例如，下图中工资和扣除是可分的数据项，工资又分为基本工资、岗位津贴和业绩津贴，扣除又分为三险和个人所得税。因此，下图的表就不符合关系模型要求。

![image-20220212164227516](https://gitee.com/enchantedqaq/cloudimage/raw/master/img/image-20220212164227516.png)

​		可以把关系和现实生活中的表格所使用的术语做一个粗略的对比

| 关系术语   | 一般表格的术语             |
| ---------- | -------------------------- |
| 关系名     | 表名                       |
| 关系模式   | 表头（表格的描述）         |
| 关系       | (一张）二维表              |
| 元组       | 记录或行                   |
| 属性       | 列                         |
| 属性名     | 列名                       |
| 属性值     | 列值                       |
| 分量       | 一条记录中的一个列值       |
| 非规范关系 | 表中有表（大表中嵌有小表） |

**2. 关系模型的数据操作与完整性约束**

​		关系模型的数据操纵主要包括==查询==、==插入==、==删除==和==更新数据==。这些操作必须满足关系的完整性约束条件。关系的完整性约束条件包括三大类: **实体完整性**、**参照完整性**和**用户自定义完整性**。

​		关系模型中的数据操作是集合操作，**操作对象和操作结果都是关系**，**即若干元组的集合**，而不像格式化模型中那样是单记录的操作方式。另一方面，**关系模型把存取路径向用户隐蔽起来，用户只要指出“干什么”或“找什么”，不必详细说明“怎么干”或“怎么找”**,从而大大地提高了数据的独立性,提高了用户生产率。

**3. 关系模型的优缺点**

​	关系模型的==优点==主要有:

- 关系模型与格式化模型不同,它是**建立在严格的数学概念的基础上**的。
- **关系模型的概念单一**。无论实体还是实体之间的联系都用关系来表示。对数据的检索和更新结果也是关系（即表)。所以其数据结构简单、清晰，用户易懂易用。
- 关系模型的存取路径对用户透明，从而**具有更高的数据独立性、更好的安全保密性**,也简化了程序员的工作和数据库开发建立的工作。

​	关系模型的==缺点==:

​		由于存取路径对用户是隐蔽的，**查询效率往往不如格式化数据模型**。为了提高性能，数据库管理系统必须对用户的查询请求进行优化，因此增加了开发数据库管理系统的难度。

### 1.3 数据库系统的结构

​		从数据库应用开发人员角度看，**数据库系统通常采用三级模式结构，这是数据库系统内部的系统结构**。从数据库最终用户角度看，数据库系统的结构分为单用户结构、主从式结构、分布式结构、客户-服务器、浏览器-应用服务器/数据库服务器多层结构等。这是数据库系统外部的体系结构。
​		本章介绍数据库系统的模式结构。

#### 1.3.1 数据库系统模式的概念

​		**在数据模型中有“型”(type) 和“值”(value) 的概念**。**型是指对某一类数据的结构和属性的说明，值是型的一个具体赋值**。例如，学生记录定义为(学号，姓名，性别，系别，年龄，籍贯）这样的记录型，而（201315130，李明，男，计算机系，19，江苏南京市)则是该记录型的一个记录值。
​		**模式(schema) 是数据库中全体数据的逻辑结构和特征的描述，它仅仅涉及型的描述，不涉及具体的值**。模式的一个具体值称为模式的一个实例(instance)。同一个模式可以有很多实例。
​		**模式是相对稳定的，而实例是相对变动的**，因为数据库中的数据是在不断更新的。模式反映的是数据的结构及其联系，而实例反映的是数据库某一时刻的状态。
​		数据库管理系统在**体系结构上**通常都具有相同的特征，即**采用三级模式结构**（早期微机上的小型数据库系统除外）并**提供两级映像功能**。

#### 1.3.2 数据库系统的三级模式结构

​		数据库系统的三级模式结构是指数据库系统是由==外模式==、==模式==和==内模式==三级构成。如下图所示：

![image-20220212170255353](https://gitee.com/enchantedqaq/cloudimage/raw/master/img/image-20220212170255353.png)

​		**1. 模式（schema）**
​		**模式也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图**。它是数据库系统模式结构的中间层，既不涉及数据的物理存储细节和硬件环境，又与具体的应用程序、所使用的应用开发工具及高级程序设计语言无关。
​		模式实际上是数据库数据在逻辑级上的视图。一个数据库只有一个模式。数据库模式以某一种数据模型为基础，统一综合地考虑了所有用户的需求，并将这些需求有机地结合成一个逻辑整体。定义模式时不仅要定义数据的逻辑结构，例如数据记录由哪些数据项构成，数据项的名字、类型、取值范围等;而且要定义数据之间的联系，定义与数据有关的安全性、完整性要求。
​		数据库管理系统提供模式数据定义语言(模式 DDL）来严格地定义模式。



























#### 1.什么是模式(Schema)

​		对数据库中数据所进行的一种结构性的描述，所观察到数据的结构信息.

![image-20220207152122733](C:\Users\EnchantedQAQ\AppData\Roaming\Typora\typora-user-images\image-20220207152122733.png)

------

#### 2.什么是视图(View）

​		某一种表现形式下表现出来的数据库中的数据

***模式(Schema)是对视图(View)的一个抽象***

***视图(View)是一种模式(Schema)下的展示的一组数据(对模式的具体)***

------

#### 3.第一范式

​		属性不可再分

![image-20220209140308816](C:\Users\EnchantedQAQ\AppData\Roaming\Typora\typora-user-images\image-20220209140308816.png)

------

#### 4.候选码/候选键

​		关系中的一个**属性组**（1个或多个属性），其值能**唯一标识一个元组**，若从该属性组中**去掉任何一个属性**，该属性组就**不能唯一标识一个元组**，则称这样的属性组称作**候选码**。

***一个关系中，可能有很多组候选码***

------

#### 5.主码(Primary Key)/主键

- 当有多个候选码时，可以选定一个作为**主码**。
- **DBMS**以**主码**为主要线索管理关系中的各个元组。

------

#### 6.主属性和非主属性

​		包含在 **任何一个 候选码中的属性** 被称作**主属性**，而**其他属性**被称作**非主属性**。

- 最简单的，候选码只包含一个属性。
- 最极端的，所有属性构成这个关系的候选码，称为**全码(All-Key)**。

------

#### 7.外码(Foreign Key)/外键

​		若关系R中 **存在一个属性组**，它 **不是R的候选码**，但它 **是另外一个关系S的候选码**，则称**这个属性组**为R的**外码**或**外键**。

***两个关系通常是靠外码连接起来的***

![image-20220209144009332](C:\Users\EnchantedQAQ\AppData\Roaming\Typora\typora-user-images\image-20220209144009332.png)

------

#### 8.实体完整性（于主码而言）

- 关系的主码中的属性值不能为空值；
- 空值：不知道或无意义的值；

***若主码为空，则出现不可标识的个体，这是不容许的***

------

#### 9.参照完整性（于外码而言）

​		如果**关系R~1~的外码Fk**与**关系R~2~的主码Pk**相对应，则**R~1~中的每一个元组的Fk值**要么**对应R~2~中的某个元组的Pk值**，要么为**空值**。

------

#### 10.用户自定义完整性

​		用户针对具体的应用环境定义的完整性约束条件。

例如：uid要求是10位数字的正整数、username不能为空等。

------

#### 11.关系代数操作

​	**关系代数操作**：**==集合操作==**和**==纯关系操作==**。

(1).**集合操作**		

| **UNION（并）**                   | **R** | **S** | **R∪S** |
| :-------------------------------- | :---: | :---: | :-----: |
| **INTERSECTION（交）**            | **R** | **S** | **R∩S** |
| **DIFFERENCE（差）**              | **R** | **S** | **R-S** |
| **Cartesian PRODUCT（笛卡尔积）** | **R** | **S** | **R×S** |

(2).**纯关系操作**

| PROJECT（投影）    |   R   |       |    π~A~(R)    |
| :----------------- | :---: | :---: | :-----------: |
| **SELECT（选择）** | **R** |       | **σ~Con~(R)** |
| **JOIN（连接）**   | **R** | **S** | **R⋈~AθB~S**  |
| **DIVISION（除）** | **R** | **S** |    **R÷S**    |



![image-20220213171531764](https://gitee.com/enchantedqaq/cloudimage/raw/master/img/image-20220213171531764.png)

